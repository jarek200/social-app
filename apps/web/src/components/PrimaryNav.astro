---
import { isAdmin } from "@stores/users";

// Mock current user - in real app, get from auth context
const currentUserId = "user-2"; // Noah is admin
const userIsAdmin = isAdmin(currentUserId);

const baseNavItems = [
  { label: "Dashboard", href: "/" },
  { label: "Feed", href: "/feed" },
  { label: "Create", href: "/create" },
  { label: "Notifications", href: "/notifications" },
  { label: "Chat", href: "/chat" },
  { label: "Analytics", href: "/analytics" },
  { label: "Profile", href: "/profile/setup" },
];

const adminNavItems = [{ label: "Admin", href: "/admin/moderation" }];

const _navItems = userIsAdmin ? [...baseNavItems, ...adminNavItems] : baseNavItems;

const _pathname = Astro.url.pathname.replace(/\/$/, "") || "/";
---

<div class="rounded-3xl border border-white/10 bg-slate-900/70 px-6 py-4 backdrop-blur">
  <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
    <div class="flex items-center gap-3">
      <div class="flex h-10 w-10 items-center justify-center rounded-2xl bg-brand-500 text-lg font-bold text-white">SA</div>
      <div>
        <p class="text-sm font-semibold uppercase tracking-wide text-slate-400">Operations</p>
        <h1 class="text-xl font-bold text-white">Social Control Center</h1>
        <p class="text-xs text-slate-500">
          Logged in as:
          <span class={`font-semibold ${userIsAdmin ? "text-amber-400" : "text-blue-400"}`}>
            {userIsAdmin ? "Admin" : "User"}
          </span>
        </p>
      </div>
    </div>
    <div class="flex items-center gap-3 text-sm">
      <button class="rounded-full border border-white/20 px-4 py-2 font-medium text-white transition hover:border-brand-400 hover:text-brand-200" type="button">
        Deploy
      </button>
      <a href="/create" class="rounded-full bg-brand-500 px-4 py-2 font-semibold text-white transition hover:bg-brand-400">
        New Post
      </a>
      <LogoutButton client:load />
    </div>
  </div>
  <div class="mt-6 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
    <nav>
      <ul class="flex items-center gap-2 text-sm text-slate-300">
        {navItems.map((item) => {
          const isRoot = item.href === "/";
          const active = isRoot ? pathname === "/" : pathname.startsWith(item.href);
          return (
            <li>
              <a
                class={`inline-flex items-center gap-2 rounded-full px-4 py-2 font-medium transition ${
                  active ? "bg-brand-500/20 text-brand-100" : "hover:bg-white/10"
                }`}
                href={item.href}
              >
                {item.label}
              </a>
            </li>
          );
        })}
      </ul>
    </nav>
    <div class="w-full lg:w-80">
      <SearchBar client:load />
    </div>
  </div>
</div>
